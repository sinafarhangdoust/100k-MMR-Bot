/* ---------- Persistent blurred background ---------- */
body::before {
  content: "";
  position: fixed;
  inset: 0;
  background-image: url("chat_background.jpg");
  background-size: cover;
  background-position: center;
  background-repeat: no-repeat;
  filter: blur(10px) brightness(0.85);
  pointer-events: none;
  z-index: -1; /* sit behind everything */
}

/* Let the backdrop show through the app wrappers */
html, body, #root, main,
.bg-background,
[class*="bg-[hsl(var(--background))]"] {
  background: transparent !important;
}

/* ---------- Subtle dark veil behind the whole chat area ---------- */
main { position: relative; }
main::before {
  content: "";
  position: absolute;
  inset: 0;
  background: rgba(0, 0, 0, 0.35);      /* tweak for more/less darkness */
  pointer-events: none;
  z-index: 0;                           /* behind the content */
}
main > * { position: relative; z-index: 1; }

/* USER bubble — DARK theme */
html.dark [data-step-type="user_message"] .bg-accent {
  background-color: rgba(0, 0, 0, 0.55) !important;
  color: #fff;
  border-radius: 20px;
  backdrop-filter: blur(6px);
  -webkit-backdrop-filter: blur(6px);
}

/* USER bubble — LIGHT theme */
html:not(.dark) [data-step-type="user_message"] .bg-accent {
  background-color: hsl(var(--accent) / 0.7) !important;
  color: hsl(var(--accent-foreground));
  border-radius: 20px;
  backdrop-filter: blur(6px);
  -webkit-backdrop-filter: blur(6px);
}

/* Assistant bubble — DARK theme */
html.dark [data-step-type="assistant_message"] .message-content {
  background-color: rgba(0, 0, 0, 0.55);
  color: #fff;
  border-radius: 20px;
  padding: 0.75rem 1rem;
  box-shadow: 0 8px 30px rgba(0,0,0,0.25);
  backdrop-filter: blur(6px);
  -webkit-backdrop-filter: blur(6px);
}

/* Assistant bubble — LIGHT theme */
html:not(.dark) [data-step-type="assistant_message"] .message-content {
  /* use your design tokens so it matches the theme */
  background-color: hsl(var(--card) / 0.7);
  color: hsl(var(--card-foreground));
  border-radius: 20px;
  padding: 0.75rem 1rem;
  box-shadow: 0 8px 30px rgba(0,0,0,0.1);
  backdrop-filter: blur(6px);
  -webkit-backdrop-filter: blur(6px);
}


/* Keep tool/trace rows (data-step-type="llm") transparent */
[data-step-type="llm"] .message-content {
  background: transparent !important;
  box-shadow: none !important;
}

/* Composer glass — same text color for both themes */
#message-composer {
  background-color: rgba(0, 0, 0, 0.45) !important;
  color: #fff !important; /* fixed text color */
  backdrop-filter: blur(6px);
  -webkit-backdrop-filter: blur(6px);
  border-radius: 20px;
}

/* Also force contenteditable text to match */
#message-composer [contenteditable="plaintext-only"],
#message-composer [contenteditable] {
  color: #fff !important;
}


/* Make miscellaneous containers transparent so the veil shows through */
.step, [data-panel-group], [data-panel] {
  background: transparent !important;
}

[data-sidebar="content"] {
  background: var(--sidebar-background) !important;
}
